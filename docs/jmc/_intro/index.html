<!doctype html>
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.79.1" /><META NAME="ROBOTS" CONTENT="INDEX, FOLLOW">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Introduction | jvmperf: Java Performance Workshop</title><meta property="og:title" content="Introduction" />
<meta property="og:description" content="Introduction into Java Mission Control with Flight Recorder
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jvmperf.net/docs/jmc/_intro/" />
<meta property="article:modified_time" content="2021-01-18T22:42:19-06:00" /><meta property="og:site_name" content="jvmperf: Java Performance Workshop" />
<meta itemprop="name" content="Introduction">
<meta itemprop="description" content="Introduction into Java Mission Control with Flight Recorder
">
<meta itemprop="dateModified" content="2021-01-18T22:42:19-06:00" />
<meta itemprop="wordCount" content="1386">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Introduction"/>
<meta name="twitter:description" content="Introduction into Java Mission Control with Flight Recorder
"/>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-187218497-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>






<link rel="preload" href="/scss/main.min.d365b133824fa7cc9e634c8a9ba97597f3759b03ad3fd78d42c3d136099b4543.css" as="style">
<link href="/scss/main.min.d365b133824fa7cc9e634c8a9ba97597f3759b03ad3fd78d42c3d136099b4543.css" rel="stylesheet" integrity="">


<script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>

<script
  src="https://unpkg.com/lunr@2.3.8/lunr.min.js"
  integrity="sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY"
  crossorigin="anonymous"></script>



<link rel="stylesheet" href="/css/prism.css"/>



  </head>
  <body class="td-page">
    <header>
      
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
        <a class="navbar-brand" href="/">
		<span class="navbar-logo"></span><span class="font-weight-bold"><i class="fas fa-cube"></i>&nbsp;&nbsp;jvmperf</span>
	</a>
	<div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
		<ul class="navbar-nav mt-2 mt-lg-0">
			
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				
				
				<a  class="nav-link active" href="/docs/" ><span class="active">Workshop</span></a>
			</li>
			
			<li class="nav-item mr-4 mb-2 mb-lg-0">
				
				
				
				
				<a  class="nav-link" href="https://github.com/cchesser/java-perf-workshop/" target="_blank" ><span>GitHub</span></a>
			</li>
			
			
			
		</ul>
	</div>
	<div class="navbar-nav d-none d-lg-block">



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this siteâ€¦"
  aria-label="Search this siteâ€¦"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.4c2eb8dbba33f901956e8f1d5ea01721.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>

</div>
</nav>

    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            




<div id="td-sidebar-menu" class="td-sidebar__inner">
  
  <form class="td-sidebar__search d-flex align-items-center">
    



<input
  type="search"
  class="form-control td-search-input"
  placeholder="&#xf002; Search this siteâ€¦"
  aria-label="Search this siteâ€¦"
  autocomplete="off"
  
  data-offline-search-index-json-src="/offline-search-index.4c2eb8dbba33f901956e8f1d5ea01721.json"
  data-offline-search-base-href="/"
  data-offline-search-max-results="10"
>


    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-docs-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    
    
    






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/" class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section">Workshop</a>
  </li>
  <ul>
    <li class="collapse show" id="docs">
      
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/prereqs/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Prerequisites</a>
  </li>
  <ul>
    <li class="collapse " id="docsprereqs">
      
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/intro/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Process and Threads</a>
  </li>
  <ul>
    <li class="collapse " id="docsintro">
      
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/jmc/" class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">Java Mission Control &amp; Flight Recorder</a>
  </li>
  <ul>
    <li class="collapse show" id="docsjmc">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page  active" id="m-docsjmc_intro" href="/docs/jmc/_intro/">Introduction</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-docsjmcadvanced" href="/docs/jmc/advanced/">Advanced Flight Recorder</a>
        
      
      
    </li>
  </ul>
</ul>

        
      
      
      
        
          






<ul class="td-sidebar-nav__section pr-md-3">
  <li class="td-sidebar-nav__section-title">
    <a  href="/docs/memory/" class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">Memory Analysis</a>
  </li>
  <ul>
    <li class="collapse " id="docsmemory">
      
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-docsmemoryheap" href="/docs/memory/heap/">Memory Heap Analysis</a>
        
      
      
      
        
          
          
          <a class="td-sidebar-link td-sidebar-link__page " id="m-docsmemorygc" href="/docs/memory/gc/">Garbage Collections</a>
        
      
      
    </li>
  </ul>
</ul>

        
      
      
    </li>
  </ul>
</ul>

  </nav>
</div>




          </div>
          <div class="d-none d-xl-block col-xl-2 td-toc d-print-none">
            
  
  
  
  
  
  <div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
  
    
    
      
    
    
    
    
    
    
    

    <a href="https://github.com/cchesser/java-perf-workshop/edit/main/docs/content/docs/jmc/_intro.md" target="_blank"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
    <a href="https://github.com/cchesser/java-perf-workshop/new/main/docs/content/docs/jmc/_intro.md?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" target="_blank"><i class="fa fa-edit fa-fw"></i> Create child page</a>
    <a href="https://github.com/cchesser/java-perf-workshop/issues/new?title=Introduction" target="_blank"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
    

  
  
    <a id="print" href="https://jvmperf.net/docs/jmc/_print/"><i class="fa fa-print fa-fw"></i> Print entire section</a>
  
  </div>





<nav id="TableOfContents">
  <ul>
    <li><a href="#java-flight-recorder">Java Flight Recorder</a>
      <ul>
        <li><a href="#higher-fidelity-on-method-profiling">Higher Fidelity on Method Profiling</a></li>
      </ul>
    </li>
    <li><a href="#java-mission-control">Java Mission Control</a></li>
    <li><a href="#start-service-with-jfr">Start Service with JFR</a>
      <ul>
        <li><a href="#start-from-the-console">Start from the console</a></li>
      </ul>
    </li>
    <li><a href="#start-flight-recording-from-jmc">Start Flight Recording from JMC</a></li>
    <li><a href="#generate-http-traffic-on-service">Generate HTTP traffic on service</a>
      <ul>
        <li><a href="#basic-test">Basic test</a></li>
        <li><a href="#using-apache-benchmark">Using Apache Benchmark</a></li>
        <li><a href="#using-loadtest">Using loadtest</a></li>
        <li><a href="#using-gatling">Using gatling</a></li>
      </ul>
    </li>
    <li><a href="#stop-flight-recorder">Stop Flight Recorder</a></li>
    <li><a href="#the-flight-recording">The Flight Recording</a>
      <ul>
        <li><a href="#code">Code</a></li>
      </ul>
    </li>
  </ul>
</nav>



          </div>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="d-none d-md-block d-print-none">
	<ol class="breadcrumb spb-1">
		










<li class="breadcrumb-item" >
	<a href="https://jvmperf.net/docs/">Workshop</a>
</li>




<li class="breadcrumb-item" >
	<a href="https://jvmperf.net/docs/jmc/">Java Mission Control &amp; Flight Recorder</a>
</li>




<li class="breadcrumb-item active" aria-current="page">
	<a href="https://jvmperf.net/docs/jmc/_intro/">Introduction</a>
</li>

	</ol>
</nav	>

            
<div class="td-content">
	<h1>Introduction</h1>
    <div class="lead">Introduction into Java Mission Control with Flight Recorder</div>
	
        <p class="reading-time"><i class="fa fa-clock" aria-hidden="true"></i> 7 minute read</p>
           
	<h2 id="java-flight-recorder">Java Flight Recorder</h2>
<p>The Java Flight Recorder (JFR) is a very low overhead profiling and diagnostics tool. It was inherited from the JRockit JVM, and it is now offered as part of the HotSpot JVM. It is designed to be &ldquo;black box&rdquo; data recorder of the the run-time, which can be used in production environments, making it an attractive tool for profiling code since it has low overhead on the JVM.</p>
<p>To enable the Flight Recorder on the JVM, the following options need to be included on the JVM:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">-XX:+UnlockCommercialFeatures -XX:+FlightRecorder
</code></pre></div><p>:heavy_exclamation_mark: Notice that you have to include <code>-XX:+UnlockCommercialFeatures</code> first in the options listing. This is because using Flight Recorder is a feature that requires additional licensing when used in production environments. One of the following licenses is required in order to utilize this in a production environment.</p>
<ul>
<li>Oracle Java SE Advanced</li>
<li>Oracle Java SE Suite</li>
</ul>
<p>However, you may use this in non-production environments without additional licensing.</p>
<h3 id="higher-fidelity-on-method-profiling">Higher Fidelity on Method Profiling</h3>
<p>To get better fidelity on method profiling, include the following options which will enable the compiler to include additional metadata on non-safe code points. This is helpful, as sometimes the metadata will not fully resolve to the correct line in the code.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">-XX:+UnlockDiagnosticVMOptions -XX:+DebugNonSafepoints
</code></pre></div><h2 id="java-mission-control">Java Mission Control</h2>
<p>We will be using Java Mission Control <em>(included in Oracle JDK 7u40)</em> to monitor and evaluate the Java flight recordings. To start up  Java Mission Control, simply executing the following in your console:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">jmc
</code></pre></div><p>ðŸ’¡ In order to be able to invoke <code>jmc</code> (Java Mission Control) from your console, it assumes <code>$JAVA_HOME/bin</code> is on your <code>$PATH</code>. If it is not included, go ahead and update your profile to include this so you can easily invoke <code>jmc</code> from your terminal.</p>
<h2 id="start-service-with-jfr">Start Service with JFR</h2>
<p>Let&rsquo;s start profiling our service. Start the service up by enabling JFR:</p>
<h3 id="start-from-the-console">Start from the console</h3>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#8f5902;font-style:italic"># Note, if you are running this server from a different folder, consider changing the SERVER_HOME</span>
<span style="color:#000">SERVER_HOME</span><span style="color:#ce5c00;font-weight:bold">=</span>java-perf-workshop-server/target
java -XX:+UnlockCommercialFeatures -XX:+FlightRecorder -XX:+UnlockDiagnosticVMOptions -XX:+DebugNonSafepoints -jar <span style="color:#000">$SERVER_HOME</span>/java-perf-workshop-server-1.1.0-SNAPSHOT.jar server server.yml
</code></pre></div><p>ðŸ’¡ Starting with Java Mission Control 5.5 <em>(included in Oracle Java 8u40)</em>, you no longer have to enable JFR prior to capturing the recording (it will dynamically enable it, after prompting about it).</p>
<h2 id="start-flight-recording-from-jmc">Start Flight Recording from JMC</h2>
<p>From Java Mission Control (JMC), you can start a flight recording by right-clicking the JVM from the <strong>JVM Browser</strong> view and selecting <strong>Start Flight Recording&hellip;</strong></p>
<p><img src="https://github.com/cchesser/java-perf-workshop/wiki/images/jmc_start_flight_recorder.png" alt="jmc_start"></p>
<p>This will open a window where you apply some settings for the recording. First select that you want this to be a <strong>Continuous recording</strong> and for Event settings, we will import a template to get some consistent settings for profiling. Within the <strong>Template Manager</strong>, select <strong>Import Files&hellip;</strong> and import the <code>profile.jfc</code> included in this folder. It should appear as <em>Java Performance Workshop Profile</em>. Select this as the <strong>Event Settings</strong> and then click on <strong>Finish</strong>.</p>
<p><img src="https://github.com/cchesser/java-perf-workshop/wiki/images/jmc_start_flight_recorder_wizard.png" alt="jmc_started"></p>
<p>Once your flight recording is being captured in a <em>Continuous</em> recording, it will show a âˆž.</p>
<p><img src="https://github.com/cchesser/java-perf-workshop/wiki/images/jmc_flight_recorder_started.png" alt="jmc_started"></p>
<p>ðŸ’¡ You can see the JFR templates (continuous / profile) which are shipped as part of the JRE in: <code>$JAVA_HOME/jre/lib/jfr</code>. These become helpful if you are wanting to compare your settings to some of the standard ones.</p>
<h2 id="generate-http-traffic-on-service">Generate HTTP traffic on service</h2>
<p>We will want to generate some traffic on the service to measure some general characteristics of the service:</p>
<ul>
<li>Throughput (requests per second)</li>
<li>Response time</li>
<li>Trend of response time over time</li>
</ul>
<p>By generating traffic on service, this gives us baseline activity in the JVM to start evaluating the flight recording. For the purpose of this workshop, we will utilize <a href="http://httpd.apache.org/docs/2.2/programs/ab.html">Apache Benchmark</a> to generate traffic on the service.</p>
<h3 id="basic-test">Basic test</h3>
<p>This service under test, is a simple web service which provides results based on a search API. When interacting with the service, you can simply supply a HTTP GET on the <em>search</em> resource with a query parameter (&lsquo;q&rsquo;) with the term that you are searching for. It will then return KCDC&rsquo;s 2015 sessions that contain that term. Example:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">curl <span style="color:#4e9a06">&#34;http://localhost:8080/search?q=jvm&#34;</span>
<span style="color:#ce5c00;font-weight:bold">{</span>
  <span style="color:#4e9a06">&#34;results&#34;</span> : <span style="color:#ce5c00;font-weight:bold">[</span> <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#34;title&#34;</span> : <span style="color:#4e9a06">&#34;Concurrency Options on the JVM&#34;</span>,
    <span style="color:#4e9a06">&#34;presenter&#34;</span> : <span style="color:#4e9a06">&#34;Jessica Kerr&#34;</span>,
    <span style="color:#4e9a06">&#34;sessionType&#34;</span> : <span style="color:#4e9a06">&#34;Regular Session&#34;</span>
  <span style="color:#ce5c00;font-weight:bold">}</span>, <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#34;title&#34;</span> : <span style="color:#4e9a06">&#34;Exploring the Actor Model with Akka.NET&#34;</span>,
    <span style="color:#4e9a06">&#34;presenter&#34;</span> : <span style="color:#4e9a06">&#34;Robert Macdonald Smith&#34;</span>,
    <span style="color:#4e9a06">&#34;sessionType&#34;</span> : <span style="color:#4e9a06">&#34;Regular Session&#34;</span>
  <span style="color:#ce5c00;font-weight:bold">}</span>, <span style="color:#ce5c00;font-weight:bold">{</span>
    <span style="color:#4e9a06">&#34;title&#34;</span> : <span style="color:#4e9a06">&#34;What&#39;s in your JVM?&#34;</span>,
    <span style="color:#4e9a06">&#34;presenter&#34;</span> : <span style="color:#4e9a06">&#34;Carl Chesser&#34;</span>,
    <span style="color:#4e9a06">&#34;sessionType&#34;</span> : <span style="color:#4e9a06">&#34;4-Hour Workshop&#34;</span>
  <span style="color:#ce5c00;font-weight:bold">}</span> <span style="color:#ce5c00;font-weight:bold">]</span>
<span style="color:#ce5c00;font-weight:bold">}</span>
</code></pre></div><h3 id="using-apache-benchmark">Using Apache Benchmark</h3>
<p>From the console, we will execute the following to generate traffic against our service. Note, we will use a very basic search of just &ldquo;a&rdquo;, since this will generate more results.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">ab -n <span style="color:#0000cf;font-weight:bold">1000</span> -c <span style="color:#0000cf;font-weight:bold">15</span> <span style="color:#4e9a06">&#34;http://localhost:8080/search?q=a&#34;</span>
</code></pre></div><h3 id="using-loadtest">Using loadtest</h3>
<p>An alternative to Apache Benchmark, is <a href="https://github.com/alexfernandez/loadtest">loadtest</a> (a node.js equivalent). To install:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sudo npm install -g loadtest
</code></pre></div><p>Then you can execute similarly:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">loadtest -n <span style="color:#0000cf;font-weight:bold">1000</span> -c <span style="color:#0000cf;font-weight:bold">15</span> <span style="color:#4e9a06">&#34;http://localhost:8080/search?q=a&#34;</span>
</code></pre></div><h3 id="using-gatling">Using gatling</h3>
<p>Alternatively, you can use <a href="https://gatling.io/">gatling</a> (a performance library with a scala dsl ).</p>
<p>This should launch the <code>WorkshopSimulation</code>.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"> mvn -f java-perf-workshop-tester/ gatling:test
</code></pre></div><div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">mvn gatling:test
</code></pre></div><p>Sample output while running:</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#ce5c00;font-weight:bold">[</span>~/java-perf-workshop/java-perf-workshop-tester<span style="color:#ce5c00;font-weight:bold">]</span>$ mvn gatling:test
<span style="color:#ce5c00;font-weight:bold">[</span>INFO<span style="color:#ce5c00;font-weight:bold">]</span> Scanning <span style="color:#204a87;font-weight:bold">for</span> projects...
<span style="color:#ce5c00;font-weight:bold">[</span>INFO<span style="color:#ce5c00;font-weight:bold">]</span>
<span style="color:#ce5c00;font-weight:bold">[</span>INFO<span style="color:#ce5c00;font-weight:bold">]</span> ------------------------------------------------------------------------
<span style="color:#ce5c00;font-weight:bold">[</span>INFO<span style="color:#ce5c00;font-weight:bold">]</span> Building java-perf-workshop-tester 1.1.0-SNAPSHOT
<span style="color:#ce5c00;font-weight:bold">[</span>INFO<span style="color:#ce5c00;font-weight:bold">]</span> ------------------------------------------------------------------------
<span style="color:#ce5c00;font-weight:bold">[</span>INFO<span style="color:#ce5c00;font-weight:bold">]</span>
<span style="color:#ce5c00;font-weight:bold">[</span>INFO<span style="color:#ce5c00;font-weight:bold">]</span> --- gatling-maven-plugin:2.2.4:test <span style="color:#ce5c00;font-weight:bold">(</span>default-cli<span style="color:#ce5c00;font-weight:bold">)</span> @ java-perf-workshop-tester ---
19:12:16,662 <span style="color:#000;font-weight:bold">|</span>-INFO in ch.qos.logback.classic.LoggerContext<span style="color:#ce5c00;font-weight:bold">[</span>default<span style="color:#ce5c00;font-weight:bold">]</span> - Could NOT find resource <span style="color:#ce5c00;font-weight:bold">[</span>logback-test.xml<span style="color:#ce5c00;font-weight:bold">]</span>
19:12:16,663 <span style="color:#000;font-weight:bold">|</span>-INFO in ch.qos.logback.classic.LoggerContext<span style="color:#ce5c00;font-weight:bold">[</span>default<span style="color:#ce5c00;font-weight:bold">]</span> - Could NOT find resource <span style="color:#ce5c00;font-weight:bold">[</span>logback.groovy<span style="color:#ce5c00;font-weight:bold">]</span>
19:12:16,663 <span style="color:#000;font-weight:bold">|</span>-INFO in ch.qos.logback.classic.LoggerContext<span style="color:#ce5c00;font-weight:bold">[</span>default<span style="color:#ce5c00;font-weight:bold">]</span> - Found resource <span style="color:#ce5c00;font-weight:bold">[</span>logback.xml<span style="color:#ce5c00;font-weight:bold">]</span> at <span style="color:#ce5c00;font-weight:bold">[</span>file:/J:/Workspaces/java-perf-workshop/java-perf-workshop-tester/target/test-classes/logback.xml<span style="color:#ce5c00;font-weight:bold">]</span>
19:12:16,663 <span style="color:#000;font-weight:bold">|</span>-WARN in ch.qos.logback.classic.LoggerContext<span style="color:#ce5c00;font-weight:bold">[</span>default<span style="color:#ce5c00;font-weight:bold">]</span> - Resource <span style="color:#ce5c00;font-weight:bold">[</span>logback.xml<span style="color:#ce5c00;font-weight:bold">]</span> occurs multiple <span style="color:#204a87">times</span> on the classpath.
19:12:16,663 <span style="color:#000;font-weight:bold">|</span>-WARN in ch.qos.logback.classic.LoggerContext<span style="color:#ce5c00;font-weight:bold">[</span>default<span style="color:#ce5c00;font-weight:bold">]</span> - Resource <span style="color:#ce5c00;font-weight:bold">[</span>logback.xml<span style="color:#ce5c00;font-weight:bold">]</span> occurs at <span style="color:#ce5c00;font-weight:bold">[</span>file:/J:/Workspaces/java-perf-workshop/java-perf-workshop-tester/target/test-classes/logback.xml<span style="color:#ce5c00;font-weight:bold">]</span>
19:12:16,663 <span style="color:#000;font-weight:bold">|</span>-WARN in ch.qos.logback.classic.LoggerContext<span style="color:#ce5c00;font-weight:bold">[</span>default<span style="color:#ce5c00;font-weight:bold">]</span> - Resource <span style="color:#ce5c00;font-weight:bold">[</span>logback.xml<span style="color:#ce5c00;font-weight:bold">]</span> occurs at <span style="color:#ce5c00;font-weight:bold">[</span>jar:file:/C:/Users/JMonterrubio/.m2/repository/io/gatling/gatling-maven-plugin/2.2.4/gatling-maven-plugin-2.2.4.jar!/logback.xml<span style="color:#ce5c00;font-weight:bold">]</span>
19:12:16,727 <span style="color:#000;font-weight:bold">|</span>-INFO in ch.qos.logback.classic.joran.action.ConfigurationAction - debug attribute not <span style="color:#204a87">set</span>
19:12:16,731 <span style="color:#000;font-weight:bold">|</span>-INFO in ch.qos.logback.core.joran.action.AppenderAction - About to instantiate appender of <span style="color:#204a87">type</span> <span style="color:#ce5c00;font-weight:bold">[</span>ch.qos.logback.core.ConsoleAppender<span style="color:#ce5c00;font-weight:bold">]</span>
19:12:16,737 <span style="color:#000;font-weight:bold">|</span>-INFO in ch.qos.logback.core.joran.action.AppenderAction - Naming appender as <span style="color:#ce5c00;font-weight:bold">[</span>CONSOLE<span style="color:#ce5c00;font-weight:bold">]</span>
19:12:16,742 <span style="color:#000;font-weight:bold">|</span>-INFO in ch.qos.logback.core.joran.action.NestedComplexPropertyIA - Assuming default <span style="color:#204a87">type</span> <span style="color:#ce5c00;font-weight:bold">[</span>ch.qos.logback.classic.encoder.PatternLayoutEncoder<span style="color:#ce5c00;font-weight:bold">]</span> <span style="color:#204a87;font-weight:bold">for</span> <span style="color:#ce5c00;font-weight:bold">[</span>encoder<span style="color:#ce5c00;font-weight:bold">]</span> property
19:12:16,781 <span style="color:#000;font-weight:bold">|</span>-INFO in ch.qos.logback.classic.joran.action.RootLoggerAction - Setting level of ROOT logger to WARN
19:12:16,782 <span style="color:#000;font-weight:bold">|</span>-INFO in ch.qos.logback.core.joran.action.AppenderRefAction - Attaching appender named <span style="color:#ce5c00;font-weight:bold">[</span>CONSOLE<span style="color:#ce5c00;font-weight:bold">]</span> to Logger<span style="color:#ce5c00;font-weight:bold">[</span>ROOT<span style="color:#ce5c00;font-weight:bold">]</span>
19:12:16,782 <span style="color:#000;font-weight:bold">|</span>-INFO in ch.qos.logback.classic.joran.action.ConfigurationAction - End of configuration.
19:12:16,783 <span style="color:#000;font-weight:bold">|</span>-INFO in ch.qos.logback.classic.joran.JoranConfigurator@7a0ac6e3 - Registering current configuration as safe fallback point

Simulation cchesser.javaperf.workshop.WorkshopSimulation started...
</code></pre></div><h2 id="stop-flight-recorder">Stop Flight Recorder</h2>
<p>After you have played traffic through the service, you can then stop your flight recording from JMC.</p>
<p><img src="https://github.com/cchesser/java-perf-workshop/wiki/images/jmc_flight_recorder_stop.png" alt="jmc_stop"></p>
<p>Then dump the whole recording.</p>
<p><img src="https://github.com/cchesser/java-perf-workshop/wiki/images/jmc_flight_recorder_dump.png" alt="jmc_dump"></p>
<h2 id="the-flight-recording">The Flight Recording</h2>
<p>From a Java Flight Recording, there are several categories of information you can view from JMC:</p>
<ul>
<li><strong>Memory</strong>: View memory utilization and garbage collection costs.</li>
<li><strong>Code</strong>: View profiling of your code to identify <em>hot spots</em> in your code base. Also, you can get additional insight to exceptions thrown, compilation costs, and class loading.</li>
<li><strong>Threads</strong>: View series of thread dumps, <em>hot</em> threads, latency events, and locking situations causing contention.</li>
<li><strong>I/O</strong>: View general I/O (file / network) costs that were occurring within your code.</li>
<li><strong>System</strong>: Get a general context of the run-time environment of the JVM.</li>
<li><strong>Events</strong>: View a full detailed log of the events within the JVM.</li>
</ul>
<h3 id="code">Code</h3>
<p>Our first walkthrough of the Flight Recording will begin with the <strong>Code</strong> view to give context of where we might be spending time with our code.</p>
<p>When you first open the <strong>Code</strong> tab, you will be brought to the <strong>Overview</strong> sub tab. This will give you a breakdown of where you are spending your time by code package and classes.</p>
<p><img src="https://github.com/cchesser/java-perf-workshop/wiki/images/jmc_code_overview.png" alt="JMC code overview"></p>
<p>To go deeper into these details, go into the <strong>Hot Methods</strong> sub tab. From here you can expand down to the method which is consuming most of your time.</p>
<p><img src="https://github.com/cchesser/java-perf-workshop/wiki/images/jmc_code_hot_methods.png" alt="JMC code hot methods"></p>
<p>You can also zoom into the timeline to scope it to a spike of events. This can be done on most view in Java Mission Control. In this case, we will zoom into a 847 ms interval:</p>
<p><img src="https://github.com/cchesser/java-perf-workshop/wiki/images/jmc_code_hot_methods_scoped.png" alt="JMC code hot methods"></p>
<p>Another helpful means of identify within a method is including the line number. This can be accomplished by right-clicking in the view and going to <strong>Distinguish Frames By</strong>, and then selecting <strong>Line Number</strong>.</p>
<p>ðŸ’¡ Generally, you don&rsquo;t need this, as it can be quite apparent by the base method being invoked where the cost is at. Though, it may be helpful to include in some contexts.</p>
<p><img src="https://github.com/cchesser/java-perf-workshop/wiki/images/jmc_code_hot_methods_line_number.png" alt="JMC code hot methods"></p>
<p><img src="https://github.com/cchesser/java-perf-workshop/wiki/images/jmc_code_hot_methods_with_line.png" alt="JMC code hot methods"></p>
<p>Walk around to look at other areas where you are spending time in your code. In many cases you find that there are very expensive areas of code that you cannot change (as you may not own it), but you can dictate whether or not it should be executed (or executed as frequently.</p>
<p>We will go into more of the different areas of the flight recording in the next lab.</p>

	
	
	<div class="text-muted mt-5 pt-3 border-top">Last modified January 18, 2021: <a  href="https://github.com/cchesser/java-perf-workshop/commit/215298cea4514c7e1db598914b178827bc496027">Correcting bulb references with emoji (215298c)</a>
</div>
</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener noreferrer" href="https://github.com/cchesser/java-perf-workshop">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2021 Carl Chesser All Rights Reserved</small>
        
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>













<script src="/js/main.min.f820bfc507c3ebefe17f8881ec4ee10013f3b89ad9555a50acf9bb1771e6823f.js" integrity="sha256-&#43;CC/xQfD6&#43;/hf4iB7E7hABPzuJrZVVpQrPm7F3Hmgj8=" crossorigin="anonymous"></script>



<script src='/js/prism.js'></script>



  </body>
</html>