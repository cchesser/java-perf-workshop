<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="en" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.96.0" />
<meta name="robots" content="index, follow">


<link rel="shortcut icon" href="/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/favicons/android-192x192.png" sizes="192x192">

<title>Garbage Collections | jvmperf: Java Performance Workshop</title>
<meta name="description" content="Analyzing garbage collections of the JVM">
<meta property="og:title" content="Garbage Collections" />
<meta property="og:description" content="Analyzing garbage collections of the JVM" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jvmperf.net/docs/memory/gc/" /><meta property="article:section" content="docs" />

<meta property="article:modified_time" content="2021-02-28T10:27:43-06:00" /><meta property="og:site_name" content="jvmperf: Java Performance Workshop" />

<meta itemprop="name" content="Garbage Collections">
<meta itemprop="description" content="Analyzing garbage collections of the JVM">
<meta itemprop="dateModified" content="2021-02-28T10:27:43-06:00" />
<meta itemprop="wordCount" content="1641">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Garbage Collections"/>
<meta name="twitter:description" content="Analyzing garbage collections of the JVM"/>




<link rel="preload" href="/scss/main.min.f11b39c068737e17af6746ee94a40c12f2d22abecbe2dedc6519f62165331a10.css" as="style">
<link href="/scss/main.min.f11b39c068737e17af6746ee94a40c12f2d22abecbe2dedc6519f62165331a10.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK"
  crossorigin="anonymous"></script>
<script defer
  src="https://unpkg.com/lunr@2.3.9/lunr.min.js"
  integrity="sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli"
  crossorigin="anonymous"></script>
<link rel="stylesheet" href="/css/prism.css"/>
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-187218497-1"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'UA-187218497-1');
}
</script>
  </head>
  <body class="td-page">
    <header>
      <nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
  <a class="navbar-brand" href="/"><span class="navbar-brand__logo navbar-logo"></span><span class="navbar-brand__name">
        <i class="fas fa-cube"></i>&nbsp;&nbsp;jvmperf
    </span></a>
  <div class="td-navbar-nav-scroll ml-md-auto" id="main_navbar">
    <ul class="navbar-nav mt-2 mt-lg-0">
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link active" href="/docs/"><i class="fas fa-tools"></i><span class="active">Workshop</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="https://github.com/cchesser/java-perf-workshop/" target="_blank"><i class="fa-brands fa-github"></i><span>GitHub</span></a>
      </li>
      <li class="nav-item mr-4 mb-2 mb-lg-0">
        <a class="nav-link" href="/contributors/"><i class="fas fa-user-friends"></i><span>Contributors</span></a>
      </li>
      </ul>
  </div>
  <div class="navbar-nav d-none d-lg-block">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.ea2cbc335467dd9e541000b2f2342da0.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>

  </div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
            
<div id="td-sidebar-menu" class="td-sidebar__inner">
  <form class="td-sidebar__search d-flex align-items-center">
    <div class="td-search td-search--offline">
  <div class="td-search__icon"></div>
  <input
    type="search"
    class="td-search__input form-control"
    placeholder="Search this site…"
    aria-label="Search this site…"
    autocomplete="off"
    
    data-offline-search-index-json-src="/offline-search-index.ea2cbc335467dd9e541000b2f2342da0.json"
    data-offline-search-base-href="/"
    data-offline-search-max-results="10"
  >
</div>

    <button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type="button" data-toggle="collapse" data-target="#td-section-nav" aria-controls="td-section-nav" aria-expanded="false" aria-label="Toggle section navigation">
    </button>
  </form>
  <nav class="collapse td-sidebar-nav" id="td-section-nav">
    <ul class="td-sidebar-nav__section pr-md-3 ul-0">
      <li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docs-li">
  <a href="/docs/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id="m-docs"><span class="">Workshop</span></a>
  <ul class="ul-1">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsprereqs-li">
  <a href="/docs/prereqs/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsprereqs"><span class="">Prerequisites</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docssetup-li">
  <a href="/docs/setup/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docssetup"><span class="">Setup</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsintro-li">
  <a href="/docs/intro/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsintro"><span class="">Process and Threads</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docsjmc-li">
  <a href="/docs/jmc/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsjmc"><span class="">Java Mission Control &amp; Flight Recorder</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsjmc_intro_jmc7-li">
  <a href="/docs/jmc/_intro_jmc7/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsjmc_intro_jmc7"><span class="">Introduction</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsjmcmethod_profiling-li">
  <a href="/docs/jmc/method_profiling/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsjmcmethod_profiling"><span class="">Method Profiling</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsjmcexceptions-li">
  <a href="/docs/jmc/exceptions/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsjmcexceptions"><span class="">Exceptions</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsjmcthreads-li">
  <a href="/docs/jmc/threads/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsjmcthreads"><span class="">Threads</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsjmcmemory-li">
  <a href="/docs/jmc/memory/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsjmcmemory"><span class="">Memory</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsjmcio_operations-li">
  <a href="/docs/jmc/io_operations/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsjmcio_operations"><span class="">I/O Operations</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsjmc_references-li">
  <a href="/docs/jmc/_references/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsjmc_references"><span class="">References</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id="m-docsmemory-li">
  <a href="/docs/memory/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docsmemory"><span class="">Memory Analysis</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmemoryheap-li">
  <a href="/docs/memory/heap/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmemoryheap"><span class="">Memory Heap Analysis</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmemorycapturing-li">
  <a href="/docs/memory/capturing/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmemorycapturing"><span class="">Capturing Heap Dumps</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmemoryjoverflow-li">
  <a href="/docs/memory/joverflow/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmemoryjoverflow"><span class="">JOverflow</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmemorymat-li">
  <a href="/docs/memory/mat/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmemorymat"><span class="">Eclipse MAT</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmemoryvisualvm-li">
  <a href="/docs/memory/visualvm/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmemoryvisualvm"><span class="">Visual VM</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docsmemorychallenge-li">
  <a href="/docs/memory/challenge/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docsmemorychallenge"><span class="">Memory Challenge</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id="m-docsmemorygc-li">
  <a href="/docs/memory/gc/" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id="m-docsmemorygc"><span class="td-sidebar-nav-active-item">Garbage Collections</span></a>
</li>
  </ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id="m-docscontainers-li">
  <a href="/docs/containers/" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id="m-docscontainers"><span class="">Containers</span></a>
  <ul class="ul-2 foldable">
    <li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontainerssetup-li">
  <a href="/docs/containers/setup/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docscontainerssetup"><span class="">Setup</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontainersjava_monitoring-li">
  <a href="/docs/containers/java_monitoring/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docscontainersjava_monitoring"><span class="">Java Monitoring Tooling</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontainersdocker_monitoring-li">
  <a href="/docs/containers/docker_monitoring/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docscontainersdocker_monitoring"><span class="">Docker Tooling</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id="m-docscontainers_references-li">
  <a href="/docs/containers/_references/" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id="m-docscontainers_references"><span class="">References</span></a>
</li>
  </ul>
</li>
  </ul>
</li>
    </ul>
  </nav>
</div>

          </aside>
          <aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
            
  
  
  
  
  
  <div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
  
    
    
      
    
    
    
    
    
    
    

    <a href="https://github.com/cchesser/java-perf-workshop/edit/main/docs/content/docs/memory/gc.md" target="_blank"><i class="fa fa-edit fa-fw"></i> Edit this page</a>
    <a href="https://github.com/cchesser/java-perf-workshop/new/main/docs/content/docs/memory/gc.md?filename=change-me.md&amp;value=---%0Atitle%3A&#43;%22Long&#43;Page&#43;Title%22%0AlinkTitle%3A&#43;%22Short&#43;Nav&#43;Title%22%0Aweight%3A&#43;100%0Adescription%3A&#43;%3E-%0A&#43;&#43;&#43;&#43;&#43;Page&#43;description&#43;for&#43;heading&#43;and&#43;indexes.%0A---%0A%0A%23%23&#43;Heading%0A%0AEdit&#43;this&#43;template&#43;to&#43;create&#43;your&#43;new&#43;page.%0A%0A%2A&#43;Give&#43;it&#43;a&#43;good&#43;name%2C&#43;ending&#43;in&#43;%60.md%60&#43;-&#43;e.g.&#43;%60getting-started.md%60%0A%2A&#43;Edit&#43;the&#43;%22front&#43;matter%22&#43;section&#43;at&#43;the&#43;top&#43;of&#43;the&#43;page&#43;%28weight&#43;controls&#43;how&#43;its&#43;ordered&#43;amongst&#43;other&#43;pages&#43;in&#43;the&#43;same&#43;directory%3B&#43;lowest&#43;number&#43;first%29.%0A%2A&#43;Add&#43;a&#43;good&#43;commit&#43;message&#43;at&#43;the&#43;bottom&#43;of&#43;the&#43;page&#43;%28%3C80&#43;characters%3B&#43;use&#43;the&#43;extended&#43;description&#43;field&#43;for&#43;more&#43;detail%29.%0A%2A&#43;Create&#43;a&#43;new&#43;branch&#43;so&#43;you&#43;can&#43;preview&#43;your&#43;new&#43;file&#43;and&#43;request&#43;a&#43;review&#43;via&#43;Pull&#43;Request.%0A" target="_blank"><i class="fa fa-edit fa-fw"></i> Create child page</a>
    <a href="https://github.com/cchesser/java-perf-workshop/issues/new?title=Garbage%20Collections" target="_blank"><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
    

  
  
    <a id="print" href="https://jvmperf.net/docs/memory/_print/"><i class="fa fa-print fa-fw"></i> Print entire section</a>
  
  </div>


            <div class="td-toc">
        <nav id="TableOfContents">
  <ul>
    <li><a href="#gc-jvm-options">GC JVM Options</a></li>
    <li><a href="#gc-log-formats">GC Log formats</a>
      <ul>
        <li><a href="#parallel-gc">Parallel GC</a></li>
        <li><a href="#concurrent-mark-sweep">Concurrent Mark Sweep</a></li>
        <li><a href="#g1">G1</a></li>
      </ul>
    </li>
    <li><a href="#type-of-collections">Type of Collections</a></li>
    <li><a href="#gathering-gc-logs">Gathering GC Logs</a>
      <ul>
        <li><a href="#enabling-logs">Enabling logs</a></li>
        <li><a href="#parsing-the-log">Parsing the log</a></li>
      </ul>
    </li>
    <li><a href="#external-tools">External Tools</a>
      <ul>
        <li><a href="#gc-easy">GC Easy</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    
            

	
		



  
  

	
		



  
  

	

          </aside>
          <main class="col-12 col-md-9 col-xl-8 pl-md-5" role="main">
            
  

            <nav aria-label="breadcrumb" class="td-breadcrumbs">
  <ol class="breadcrumb">
  <li class="breadcrumb-item">
    <a href="https://jvmperf.net/docs/">Workshop</a>
  </li>
  <li class="breadcrumb-item">
    <a href="https://jvmperf.net/docs/memory/">Memory Analysis</a>
  </li>
  <li class="breadcrumb-item active" aria-current="page">
    <a href="https://jvmperf.net/docs/memory/gc/" aria-disabled="true" class="btn-link disabled">Garbage Collections</a>
  </li>
  </ol>
</nav>
            
<div class="td-content">
	<h1>Garbage Collections</h1>
	<div class="lead">Analyzing garbage collections of the JVM</div>
	<header class="article-meta">
		

  
    


  
    


  

		
			<p class="reading-time"><i class="fa-solid fa-clock" aria-hidden="true"></i>&nbsp; 8 minute read &nbsp;</p>

		
	</header>    
	<p>A key piece to understanding what is happening in terms of GC cycles within your service,
is enabling GC logs. In this section, we are going to do some analysis on the JVM in regards to it&rsquo;s garbage collection (GC)
cycles.</p>


<div class="alert alert-info" role="alert">
<h4 class="alert-heading">Prerequisite</h4>

    <a href="https://www.r-project.org/">R environment</a> <em>(If you want to try parsing some of the logs)</em>

</div>

<h2 id="gc-jvm-options">GC JVM Options</h2>
<p>Here is a set of JVM options you can enable on your service and how to interpret those logs.</p>
<ul>
<li><code>-XX:+PrintGCDetails</code>: Includes more details within your GC log</li>
<li><code>-XX:+PrintGCDateStamps</code>: Have a readable date/time string to correlate events in your log. Without
this option, your GC log will have elapsed time since the JVM was started. This format (which is reported)
in seconds (with millisecond precision), is not easy for someone to quickly correlate when this event was
logged (as you have to infer the time based on when the JVM was started).</li>
<li><code>-Xloggc</code>: Specifies the log file for the garbage collection logs (otherwise will go to stdout).
💡 Note: <code>-verbose:gc</code> is NOT necessary when you set <code>Xloggc</code> (it is implied).</li>
<li><code>-XX:+UseGCLogFileRotation</code>: Support rotating your GC log file (you don&rsquo;t want to let this get too
big).</li>
<li><code>-XX:GCLogFileSize</code>: Size of the file for rotation (ex. <code>10M</code>).</li>
<li><code>-XX:NumberOfGCLogFiles</code>: Number of GC log files to maintain (ex. <code>3</code>). 💡 Note: if you are monitoring
your log file with another solution (like <a href="http://www.splunk.com/">splunk</a> or
<a href="https://www.elastic.co/products/logstash">logstash</a>), you typically don&rsquo;t need to be keeping an inventory of
rolled files around, unless you are concerned about log forwarding failing and want to ensure a given amount
is still capable of being captured from a host.</li>
</ul>
<h2 id="gc-log-formats">GC Log formats</h2>
<p>With different garbage collectors in the JVM, you will get slightly different GC log formats.</p>
<h3 id="parallel-gc">Parallel GC</h3>
<pre tabindex="0"><code>2015-09-30T10:57:20.215+0600: 0.847: [GC (Allocation Failure) [PSYoungGen: 65536K-&gt;10748K(76288K)] 65536K-&gt;12607K(251392K), 0.0118637 secs] [Times: user=0.03 sys=0.01, real=0.01 secs]
2015-09-30T10:57:20.556+0600: 1.188: [GC (Metadata GC Threshold) [PSYoungGen: 44312K-&gt;10748K(141824K)] 46171K-&gt;12786K(316928K), 0.0077755 secs] [Times: user=0.03 sys=0.00, real=0.01 secs]
2015-09-30T10:57:20.564+0600: 1.196: [Full GC (Metadata GC Threshold) [PSYoungGen: 10748K-&gt;0K(141824K)] [ParOldGen: 2038K-&gt;10444K(116736K)] 12786K-&gt;10444K(258560K), [Metaspace: 20976K-&gt;20976K(1067008K)], 0.0286381 secs] [Times: user=0.14 sys=0.01, real=0.03 secs]
</code></pre><h3 id="concurrent-mark-sweep">Concurrent Mark Sweep</h3>
<pre tabindex="0"><code>2015-09-30T11:11:35.994+0600: 0.838: [GC (Allocation Failure) 0.838: [ParNew: 69952K-&gt;8703K(78656K), 0.0128204 secs] 69952K-&gt;12781K(253440K), 0.0128848 secs] [Times: user=0.04 sys=0.01, real=0.01 secs]
2015-09-30T11:11:38.009+0600: 2.853: [GC (CMS Initial Mark) [1 CMS-initial-mark: 4077K(174784K)] 67493K(253440K), 0.0088311 secs] [Times: user=0.04 sys=0.00, real=0.01 secs]
2015-09-30T11:11:38.018+0600: 2.862: [CMS-concurrent-mark-start]
2015-09-30T11:11:38.018+0600: 2.862: [CMS-concurrent-mark: 0.000/0.000 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]
2015-09-30T11:11:38.018+0600: 2.862: [CMS-concurrent-preclean-start]
2015-09-30T11:11:38.019+0600: 2.863: [CMS-concurrent-preclean: 0.001/0.001 secs] [Times: user=0.01 sys=0.00, real=0.00 secs]
2015-09-30T11:11:38.019+0600: 2.863: [CMS-concurrent-abortable-preclean-start]
 CMS: abort preclean due to time 2015-09-30T11:11:43.074+0600: 7.918: [CMS-concurrent-abortable-preclean: 1.233/5.055 secs] [Times: user=1.23 sys=0.01, real=5.06 secs]
2015-09-30T11:11:43.074+0600: 7.918: [GC (CMS Final Remark) [YG occupancy: 63415 K (78656 K)]7.918: [Rescan (parallel) , 0.0052614 secs]7.924: [weak refs processing, 0.0000337 secs]7.924: [class unloading, 0.0029068 secs]7.927: [scrub symbol table, 0.0025781 secs]7.929: [scrub string table, 0.0002699 secs][1 CMS-remark: 4077K(174784K)] 67493K(253440K), 0.0117740 secs] [Times: user=0.04 sys=0.01, real=0.01 secs]
2015-09-30T11:11:43.086+0600: 7.930: [CMS-concurrent-sweep-start]
2015-09-30T11:11:43.086+0600: 7.930: [CMS-concurrent-sweep: 0.000/0.000 secs] [Times: user=0.00 sys=0.00, real=0.00 secs]
2015-09-30T11:11:43.087+0600: 7.930: [CMS-concurrent-reset-start]
2015-09-30T11:11:43.110+0600: 7.954: [CMS-concurrent-reset: 0.023/0.023 secs] [Times: user=0.01 sys=0.01, real=0.03 secs]
</code></pre><h3 id="g1">G1</h3>
<pre tabindex="0"><code>015-09-30T11:13:03.870+0600: 0.395: [GC pause (G1 Evacuation Pause) (young), 0.0052206 secs]
   [Parallel Time: 1.9 ms, GC Workers: 8]
      [GC Worker Start (ms): Min: 395.4, Avg: 395.5, Max: 395.8, Diff: 0.3]
      [Ext Root Scanning (ms): Min: 0.0, Avg: 0.3, Max: 1.1, Diff: 1.1, Sum: 2.0]
      [Update RS (ms): Min: 0.0, Avg: 0.0, Max: 0.0, Diff: 0.0, Sum: 0.0]
         [Processed Buffers: Min: 0, Avg: 0.0, Max: 0, Diff: 0, Sum: 0]
      [Scan RS (ms): Min: 0.0, Avg: 0.0, Max: 0.0, Diff: 0.0, Sum: 0.1]
      [Code Root Scanning (ms): Min: 0.0, Avg: 0.1, Max: 0.4, Diff: 0.4, Sum: 0.5]
      [Object Copy (ms): Min: 0.7, Avg: 1.4, Max: 1.6, Diff: 0.9, Sum: 11.4]
      [Termination (ms): Min: 0.0, Avg: 0.0, Max: 0.0, Diff: 0.0, Sum: 0.1]
      [GC Worker Other (ms): Min: 0.0, Avg: 0.0, Max: 0.0, Diff: 0.0, Sum: 0.1]
      [GC Worker Total (ms): Min: 1.5, Avg: 1.8, Max: 1.8, Diff: 0.3, Sum: 14.2]
      [GC Worker End (ms): Min: 397.3, Avg: 397.3, Max: 397.3, Diff: 0.0]
   [Code Root Fixup: 0.1 ms]
   [Code Root Purge: 0.1 ms]
   [Clear CT: 0.1 ms]
   [Other: 3.0 ms]
      [Choose CSet: 0.0 ms]
      [Ref Proc: 2.7 ms]
      [Ref Enq: 0.0 ms]
      [Redirty Cards: 0.2 ms]
      [Humongous Reclaim: 0.0 ms]
      [Free CSet: 0.0 ms]
   [Eden: 24.0M(24.0M)-&gt;0.0B(39.0M) Survivors: 0.0B-&gt;3072.0K Heap: 24.0M(256.0M)-&gt;5754.5K(256.0M)]
 [Times: user=0.02 sys=0.01, real=0.00 secs]
2015-09-30T11:13:04.343+0600: 0.868: [GC pause (G1 Evacuation Pause) (young), 0.0082908 secs]
   [Parallel Time: 5.1 ms, GC Workers: 8]
      [GC Worker Start (ms): Min: 868.3, Avg: 868.4, Max: 868.8, Diff: 0.5]
      [Ext Root Scanning (ms): Min: 0.0, Avg: 0.3, Max: 1.7, Diff: 1.7, Sum: 2.7]
      [Update RS (ms): Min: 0.0, Avg: 0.1, Max: 0.2, Diff: 0.2, Sum: 0.5]
         [Processed Buffers: Min: 0, Avg: 0.4, Max: 1, Diff: 1, Sum: 3]
      [Scan RS (ms): Min: 0.0, Avg: 0.0, Max: 0.0, Diff: 0.0, Sum: 0.1]
      [Code Root Scanning (ms): Min: 0.0, Avg: 0.4, Max: 1.4, Diff: 1.4, Sum: 3.5]
      [Object Copy (ms): Min: 3.2, Avg: 4.0, Max: 4.6, Diff: 1.4, Sum: 32.1]
      [Termination (ms): Min: 0.0, Avg: 0.1, Max: 0.1, Diff: 0.1, Sum: 0.6]
      [GC Worker Other (ms): Min: 0.0, Avg: 0.0, Max: 0.0, Diff: 0.0, Sum: 0.1]
      [GC Worker Total (ms): Min: 4.6, Avg: 4.9, Max: 5.0, Diff: 0.5, Sum: 39.5]
      [GC Worker End (ms): Min: 873.3, Avg: 873.3, Max: 873.4, Diff: 0.0]
   [Code Root Fixup: 0.3 ms]
   [Code Root Purge: 0.1 ms]
   [Clear CT: 0.1 ms]
   [Other: 2.7 ms]
      [Choose CSet: 0.0 ms]
      [Ref Proc: 2.4 ms]
      [Ref Enq: 0.0 ms]
      [Redirty Cards: 0.1 ms]
      [Humongous Reclaim: 0.0 ms]
      [Free CSet: 0.1 ms]
   [Eden: 39.0M(39.0M)-&gt;0.0B(147.0M) Survivors: 3072.0K-&gt;6144.0K Heap: 44.6M(256.0M)-&gt;13.9M(256.0M)]
 [Times: user=0.04 sys=0.00, real=0.01 secs]
2015-09-30T11:13:04.650+0600: 1.176: [GC pause (Metadata GC Threshold) (young) (initial-mark), 0.0090083 secs]
   [Parallel Time: 5.5 ms, GC Workers: 8]
      [GC Worker Start (ms): Min: 1175.9, Avg: 1176.0, Max: 1176.0, Diff: 0.1]
      [Ext Root Scanning (ms): Min: 1.1, Avg: 1.2, Max: 1.4, Diff: 0.3, Sum: 9.4]
      [Update RS (ms): Min: 0.0, Avg: 0.1, Max: 0.2, Diff: 0.2, Sum: 1.2]
         [Processed Buffers: Min: 0, Avg: 1.1, Max: 2, Diff: 2, Sum: 9]
      [Scan RS (ms): Min: 0.1, Avg: 0.1, Max: 0.3, Diff: 0.2, Sum: 1.1]
      [Code Root Scanning (ms): Min: 0.0, Avg: 0.2, Max: 0.5, Diff: 0.5, Sum: 2.0]
      [Object Copy (ms): Min: 3.4, Avg: 3.7, Max: 3.8, Diff: 0.4, Sum: 29.3]
      [Termination (ms): Min: 0.0, Avg: 0.0, Max: 0.0, Diff: 0.0, Sum: 0.0]
      [GC Worker Other (ms): Min: 0.0, Avg: 0.0, Max: 0.0, Diff: 0.0, Sum: 0.2]
      [GC Worker Total (ms): Min: 5.4, Avg: 5.4, Max: 5.5, Diff: 0.1, Sum: 43.3]
      [GC Worker End (ms): Min: 1181.4, Avg: 1181.4, Max: 1181.4, Diff: 0.0]
   [Code Root Fixup: 0.3 ms]
   [Code Root Purge: 0.0 ms]
   [Clear CT: 0.1 ms]
   [Other: 3.0 ms]
      [Choose CSet: 0.0 ms]
      [Ref Proc: 2.7 ms]
      [Ref Enq: 0.0 ms]
      [Redirty Cards: 0.1 ms]
      [Humongous Reclaim: 0.0 ms]
      [Free CSet: 0.1 ms]
   [Eden: 33.0M(147.0M)-&gt;0.0B(140.0M) Survivors: 6144.0K-&gt;13.0M Heap: 46.9M(256.0M)-&gt;20.9M(256.0M)]
 [Times: user=0.04 sys=0.00, real=0.01 secs]
2015-09-30T11:13:04.660+0600: 1.185: [GC concurrent-root-region-scan-start]
2015-09-30T11:13:04.664+0600: 1.190: [GC concurrent-root-region-scan-end, 0.0046509 secs]
2015-09-30T11:13:04.664+0600: 1.190: [GC concurrent-mark-start]
2015-09-30T11:13:04.665+0600: 1.190: [GC concurrent-mark-end, 0.0007287 secs]
2015-09-30T11:13:04.665+0600: 1.190: [GC remark 1.190: [Finalize Marking, 0.0001736 secs] 1.191: [GC ref-proc, 0.0000411 secs] 1.191: [Unloading, 0.0016740 secs], 0.0020377 secs]
 [Times: user=0.01 sys=0.00, real=0.00 secs]
2015-09-30T11:13:04.667+0600: 1.193: [GC cleanup 21M-&gt;14M(256M), 0.0004254 secs]
 [Times: user=0.01 sys=0.00, real=0.00 secs]
</code></pre><h2 id="type-of-collections">Type of Collections</h2>
<p>A simple rule to watch for on your logs is the prefix of either:</p>
<pre tabindex="0"><code>[GC ...      &lt;- Minor GC cycle (young gen)
[Full GC ... &lt;- Full GC cycle
</code></pre><p>(❗) Explicit GCs can also be identified, which is when something is invoking the <code>System.gc()</code> API. Note, this is not good thing, as
something is forcing a GC cycle to occur, rather than letting the JVM trigger this on its own (what should naturally occur).</p>
<pre tabindex="0"><code>2015-09-30T12:23:44.425+0600: 195.699: [GC (System.gc()) [PSYoungGen: 39223K-&gt;3562K(76288K)] 49685K-&gt;14032K(190464K), 0.0047880 secs] [Times: user=0.02 sys=0.00, real=0.01 secs]
2015-09-30T12:23:44.430+0600: 195.704: [Full GC (System.gc()) [PSYoungGen: 3562K-&gt;0K(76288K)] [ParOldGen: 10469K-&gt;9174K(114176K)] 14032K-&gt;9174K(190464K), [Metaspace: 25137K-&gt;25137K(1071104K)], 0.0724521 secs] [Times: user=0.38 sys=0.01, real=0.07 secs]
</code></pre><p>It is generally recommended to use the <code>-XX:+DisableExplicitGC</code> JVM option to disable forceful GC events. This will allow
the JVM to still have garbage collections, but it disables them from being triggered explicitly. The description of this option:</p>
<blockquote>
<p>By default calls to System.gc() are enabled (-XX:-DisableExplicitGC). Use -XX:+DisableExplicitGC to disable calls to System.gc(). Note that the JVM still performs garbage collection when necessary.</p>
</blockquote>
<h2 id="gathering-gc-logs">Gathering GC Logs</h2>
<h3 id="enabling-logs">Enabling logs</h3>
<p>With our service, let&rsquo;s go ahead and start it up with GC logging enabled:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Navigate to the root directory of this project</span>
</span></span><span style="display:flex;"><span>java -XX:+PrintGCDetails -XX:+PrintGCDateStamps -Xloggc:gc.log -XX:GCLogFileSize<span style="color:#ce5c00;font-weight:bold">=</span>5M -XX:NumberOfGCLogFiles<span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">2</span> <span style="color:#4e9a06">\
</span></span></span><span style="display:flex;"><span><span style="color:#4e9a06"></span> -jar java-perf-workshop-server/target/java-perf-workshop-server-1.1.0-SNAPSHOT.jar server server.yml 
</span></span></code></pre></div><h3 id="parsing-the-log">Parsing the log</h3>
<p>For parsing the logs, we are just going to show a simple approach using <a href="https://www.r-project.org/">R</a> to parse the
<code>gc.log</code> that we created. To do this, we will use the <code>stringr</code> package.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-r" data-lang="r"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Including stringr package for regex</span>
</span></span><span style="display:flex;"><span><span style="color:#000">library</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">stringr</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Navigating to where the project is at on my filesystem</span>
</span></span><span style="display:flex;"><span><span style="color:#000">setwd</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;~/java-perf-workshop&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Read the GC log file in</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gc</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">readLines</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;gc.log&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Regex the matches</span>
</span></span><span style="display:flex;"><span><span style="color:#000">matches</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">str_match</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">gc</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;(\\d+)K-&gt;(\\d+)K\\((\\d+)K\\),\\s(\\d+.\\d+)\\ssecs.*\\[Times\\: user=(\\d+.\\d+) sys=(\\d+.\\d+), real=(\\d+.\\d+) secs&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Look at what matches, now we want to filter out the NA</span>
</span></span><span style="display:flex;"><span><span style="color:#000">matches</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Filter content out and convert to a data frame</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gc.df</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">data.frame</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">na.omit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">matches[</span><span style="color:#000;font-weight:bold">,</span><span style="color:#0000cf;font-weight:bold">-1</span><span style="color:#000">]</span><span style="color:#000;font-weight:bold">),</span> <span style="color:#000">stringsAsFactors</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#204a87;font-weight:bold">FALSE</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># Add a column header to describe fields</span>
</span></span><span style="display:flex;"><span><span style="color:#000">colnames</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">gc.df</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">&lt;-</span> <span style="color:#000">c</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#34;HeapUsedBeforeGC_KB&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#4e9a06">&#34;HeapUsedAfterGC_KB&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;HeapCapacity_KB&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;GCPauseTime_Sec&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;GCUserTime_Sec&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;GCSysTime_Sec&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;GCRealTime_Sec&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># List out the contents of the data frame</span>
</span></span><span style="display:flex;"><span><span style="color:#000">gc.df</span>
</span></span></code></pre></div><p>Example output:</p>
<pre tabindex="0"><code>  HeapUsedBeforeGC_KB HeapUsedAfterGC_KB HeapCapacity_KB GCPauseTime_Sec GCUserTime_Sec GCSysTime_Sec GCRealTime_Sec
1               65536              12554          251392       0.0091645           0.03          0.01           0.01
2               45883              12707          316928       0.0092271           0.03          0.01           0.01
</code></pre><p>Reminder on the types of time being collected:</p>
<ul>
<li><code>GCUserTime_Sec</code>: User space time</li>
<li><code>GCSysTime_Sec</code>: Kernel space time (operating system)</li>
<li><code>GCRealTime_Sec</code>: Complete time taken</li>
</ul>
<p>Notice that the <code>GCRealTime_Sec</code> should closely align with the <code>GCPauseTime_Sec</code> value (just rounded up). If you notice that the
<code>GCUserTime_Sec</code> is much larger than the <code>GCRealTime_Sec</code>, you can conclude that multiple threads are executing garbage collection,
as <code>GCUserTime_Sec</code> is just the sum time of all the threads.</p>
<h2 id="external-tools">External Tools</h2>
<h3 id="gc-easy">GC Easy</h3>
<p>There&rsquo;s an existing tool <a href="http://gceasy.io/">GC Easy</a> which will do GC log parsing and analysis as well.</p>

	
	
	<div class="text-muted mt-5 pt-3 border-top">
  Last modified February 28, 2021: <a href="https://github.com/cchesser/java-perf-workshop/commit/3d8c0cff841383ed4965511aef875018509f0eda">structure content a bit (#44) (3d8c0cf)</a>
</div>

</div>


          </main>
        </div>
      </div>
      
<footer class="bg-dark py-5 row d-print-none">
  <div class="container-fluid mx-sm-5">
    <div class="row">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
        
        
        
<ul class="list-inline mb-0">
  
  <li class="list-inline-item mx-2 h3" data-toggle="tooltip" data-placement="top" title="GitHub" aria-label="GitHub">
    <a class="text-white" target="_blank" rel="noopener" href="https://github.com/cchesser/java-perf-workshop" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="col-12 col-sm-4 text-center py-2 order-sm-2">
        <small class="text-white">&copy; 2022 - All Rights Reserved</small>
        
	
		
	
      </div>
    </div>
  </div>
</footer>


    </div>
    <script src="/js/main.min.2c5eedffe8e9b94b75ee34dd37e21d360b6e9ff02905c7aeddaad8c99b11f011.js" integrity="sha256-LF7t/&#43;jpuUt17jTdN&#43;IdNgtun/ApBceu3arYyZsR8BE=" crossorigin="anonymous"></script>
<script src='/js/prism.js'></script>
<script src='/js/tabpane-persist.js'></script>

  </body>
</html>